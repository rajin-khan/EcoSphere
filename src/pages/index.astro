---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import BlogCard from '../components/BlogCard.astro';

// 1. Get all blog posts, sorted by date
const sortedPosts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// 2. Separate the featured post from the rest
const featuredPost = sortedPosts[0];
const otherPosts = sortedPosts.slice(1);
---
<BaseLayout title="EcoSphere - Science & Environmental Blog" description="A blog exploring environmental science, climate research, and sustainability.">
  <div class="container">
    <!-- Featured Article Section -->
    {featuredPost && (
      <section class="featured-section">
        <BlogCard post={featuredPost} isFeatured={true} />
      </section>
    )}

    <!-- Blog Grid Section -->
    {otherPosts.length > 0 && (
      <div class="blog-grid">
        {otherPosts.map(post => <BlogCard post={post} />)}
      </div>
    )}
  </div>
</BaseLayout>

<style>
  .featured-section {
    padding: 4rem 0;
  }
</style>